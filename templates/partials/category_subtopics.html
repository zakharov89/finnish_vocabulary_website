<div class="category-grid">
  {% for sub in subcategories %}
    <div class="category-card {% if sub.count is defined and sub.count == 0 %}category-card--empty{% endif %}">
      <div class="category-header">
        <a href="{{ url_for('show_category', category_name=sub.name) }}" class="category-link">
          <span class="title">{{ sub.name }}</span>
          {% if sub.count is defined %}
            <span class="category-count">&nbsp;({{ sub.count }})</span>
          {% endif %}
        </a>

        {% if categories.get(sub.id) %}
        <button type="button"
                class="subcat-toggle"
                data-cat-id="{{ sub.id }}">
            â–¼
        </button>
        {% endif %}
      </div>

      {% if categories.get(sub.id) %}
        <div class="subcats" data-subcats-for="{{ sub.id }}" style="display: none;">
          {% for child in categories.get(sub.id) %}
            <a class="subcat {% if child.count is defined and child.count == 0 %}subcat--empty{% endif %}"
               href="{{ url_for('show_category', category_name=child.name) }}">
              <span class="subcat-name">{{ child.name }}</span>
              {% if child.count is defined %}
                <span class="subcat-count">&nbsp;({{ child.count }})</span>
              {% endif %}
            </a>
          {% endfor %}
        </div>
      {% endif %}
    </div>
  {% endfor %}
</div>
