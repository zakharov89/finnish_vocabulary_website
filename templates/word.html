{% extends "base.html" %}
{% block content %}

<h1>{{ word_name }}</h1>
{% if pos_name %}
    <p><em>({{ pos_name }})</em></p>
{% endif %}

{% set type_names = {
    "synonym": "Synonyms",
    "antonym": "Antonyms",
    "same root": "Same root",
    "compound of": "Compound of",
    "derived from": "Derived from",
    "part of": "Part of"
} %}

{% for meaning in meanings %}
<div class="meaning">
    <p>
        <strong>{{ meaning.meaning_number }}.</strong>
        <span class="translation">{{ ", ".join(meaning.translations) }}</span>
    </p>

   {% if meaning.examples %}
    <div class="examples">
        <button class="expand-btn">Show Examples</button>
        <div class="example-content" style="display: none;">
            {% for ex in meaning.examples %}
                <p>
                    {{ ex.text }}
                    {% if ex.translation %}
                        <br><em>{{ ex.translation }}</em>
                    {% endif %}
                </p>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!--
    {% if meaning.relations %}
    <div class="relations">
        {% set rel_types = {} %}
        {% for rel in meaning.relations %}
            {% if rel.type not in rel_types %}
                {% set rel_types = rel_types.update({rel.type: [rel.word]}) or rel_types %}
            {% else %}
                {% set rel_types = rel_types.update({rel.type: rel_types[rel.type] + [rel.word]}) or rel_types %}
            {% endif %}
        {% endfor %}

        {% for type, words in rel_types.items() %}
            <p><strong>{{ type_names[type] }}:</strong>
                {% for w in words %}
                    <a href="{{ url_for('show_word', word_name=w) }}">{{ w }}</a>{% if not loop.last %}, {% endif %}
                {% endfor %}
            </p>
        {% endfor %}
    </div>
    {% endif %}
    -->

</div>
{% endfor %}

<!--
{% if word_relations %}
<div class="relations">
    {% set wr_types = {} %}
    {% for rel in word_relations %}
        {% if rel.type not in wr_types %}
            {% set wr_types = wr_types.update({rel.type: [rel.word]}) or wr_types %}
        {% else %}
            {% set wr_types = wr_types.update({rel.type: wr_types[rel.type] + [rel.word]}) or wr_types %}
        {% endif %}
    {% endfor %}

    {% for type, words in wr_types.items() %}
        <p><strong>{{ type_names[type] }}:</strong>
            {% for w in words %}
                <a href="{{ url_for('show_word', word_name=w) }}">{{ w }}</a>{% if not loop.last %}, {% endif %}
            {% endfor %}
        </p>
    {% endfor %}
</div>
{% endif %}
-->

<!--
{% if categories %}
<div class="categories">
    <button class="expand-btn">Show Categories</button>
    <div class="category-content" style="display: none;">
        {% for cat in categories %}
            <a href="{{ url_for('show_category', category_name=cat['name']) }}" class="category-pill">{{ cat['name'] }}</a>
        {% endfor %}
    </div>
</div>
{% endif %}
-->
{% if categories %}
<div class="categories">
    <strong>Categories:</strong>
    {% for cat in categories %}
        <a href="{{ url_for('show_category', category_name=cat['name']) }}">{{ cat['name'] }}</a>
    {% endfor %}
</div>
{% endif %}

<script>
document.querySelectorAll('.expand-btn').forEach(function(btn) {
    btn.addEventListener('click', function() {
        const content = btn.nextElementSibling; // hidden div (.example-content or .category-content)
        content.style.display = content.style.display === 'none' ? 'block' : 'none';
        btn.textContent = content.style.display === 'none' ? 
            btn.textContent.replace('Hide', 'Show') : 
            btn.textContent.replace('Show', 'Hide');
    });
});
</script>
  
{% endblock %}

