{% extends "base.html" %}
{% block content %}

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="flash {{ category }}">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}

<div class="container mt-5">
    <h2>Edit Word: <a href="{{ url_for('show_word', word_name=word.word) }}" target="_blank">
        {{ word.word }}
    </a></h2>
    

    <!-- Update Word Form -->
    <form method="POST" class="mb-3">
        <div class="mb-3">
            <input type="text" class="admin-input" name="word" id="word" value="{{ word.word }}" required placeholder="Enter word"> 
        </div>
       
        
   

    <!-- Level -->
    <p>
        <select name="level" class="admin-select" required>
            {% for level in levels %}
                <option value="{{ level.id }}" {% if word['level'] == level.id %}selected{% endif %}>
                    {{ level.name }}
                </option>
            {% endfor %}
        </select>
    </p>
    
    <button type="submit" class="admin-btn">Update Word</button>
    </form>
    <p>
    <a href="{{ url_for('admin_dashboard') }}" class="admin-btn-small">Back to Dashboard</a>
    </p>

    
    <hr>
    <h3>Meanings</h3>

    {% for pos_name, meanings in meanings_by_pos.items() %}
    <h4>{{ pos_name }}</h4>
    <div class="list-group mb-3">
        {% for meaning in meanings %}
        <div class="meaning-block">
            <em>Translations:</em> <strong>{{ meaning.translations | join(", ") }}</strong><br>
            <em>Examples:</em>
            <ul class="examples">
            {% for ex, ex_tr in meaning.examples %}
                <li>{{ ex }} {% if ex_tr %} â€” {{ ex_tr }}{% endif %}</li>
            {% endfor %}
            </ul>
            <em>Finnish definition:</em> {{ meaning.definition }}<br>
            <em>Notes:</em> {{ meaning.notes }}
            <div class="mt-2 d-flex gap-2">
            <a href="{{ url_for('admin_edit_meaning', meaning_id=meaning.id) }}" class="admin-btn btn-warning">Edit Meaning</a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endfor %}

    <p>
        <a href="{{ url_for('admin_add_meaning', word_id=word.id) }}" class="admin-btn">Add Meaning</a>
    </p>

    <!-- Delete Word -->
    <form method="POST" action="{{ url_for('admin_delete_word', word_id=word.id) }}" 
          onsubmit="return confirm('Are you sure you want to delete this word and all its meanings?');" class="mb-4">
        <button type="submit" class="admin-btn delete-btn">Delete Word</button>
    </form>


    <p>
        <a href="{{ url_for('admin_dashboard') }}" class="admin-btn-small">Back to Dashboard</a>
    </p>

</div>
{% endblock %}
