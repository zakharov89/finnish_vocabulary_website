<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <title>{{ title if title else "Finnish Vocabulary" }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600&display=swap" rel="stylesheet">
</head>

{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
<script>
document.addEventListener("DOMContentLoaded", () => {
    const container = document.getElementById("toast-container");
    if (!container) return;

    {% for category_name, message in messages %}
        const el = document.createElement("div");
        el.className = "toast {{ category_name }}";
        el.textContent = {{ message|tojson }};
        container.appendChild(el);

        setTimeout(() => el.remove(), 4000);
    {% endfor %}
});
</script>
{% endif %}
{% endwith %}

<body>
    <div id="toast-container"></div>
    <header>
        <a class="logo" href="{{ url_for('home') }}">Finnish Vocabulary</a>
        <nav class="top-nav">
            <a href="{{ url_for('home') }}"
               class="{% if request.endpoint == 'home' %}active{% endif %}">
                Home
            </a>

           
            <a href="{{ url_for('categories') }}"
               class="{% if request.endpoint in ['categories', 'show_category'] %}active{% endif %}">
                Topics
            </a>

            <a href="{{ url_for('words_table') }}"
                class="{% if request.endpoint in ['words_table', 'words_cards', 'words_flashcards', 'show_word'] %}active{% endif %}">
                Dictionary
            </a>


            <a href="{{ url_for('search') }}"
               class="{% if request.endpoint == 'search' %}active{% endif %}">
                Search
            </a>

            <a href="{{ url_for('about') }}"
               class="{% if request.endpoint == 'about' %}active{% endif %}">
                About
            </a>
        </nav>
    </header>

    <main>
        {% block content %}{% endblock %}
    </main>

    <footer>
        <p>&copy; 2025 Finnish Vocabulary Project, Alexander Zakharov</p>
    </footer>

    {# --- Bottom navigation (mobile only, via CSS) --- #}
   <nav class="bottom-nav">
    <a href="{{ url_for('home') }}"
       class="bottom-nav-item {% if request.endpoint == 'home' %}active{% endif %}">
        <span class="bottom-nav-icon" aria-hidden="true">
            <!-- Home icon -->
           <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#3A57E8" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 10.5L12 3L21 10.5" />
            <path d="M5.5 9V20H18.5V9" />
            </svg>

        </span>
        <span class="bottom-nav-label">Home</span>
    </a>

    <a href="{{ url_for('words_table') }}"
       class="bottom-nav-item {% if request.endpoint in ['words_table', 'words_cards', 'words_flashcards'] %}active{% endif %}">
        <span class="bottom-nav-icon" aria-hidden="true">
            <!-- Book / words icon -->
          <svg width="26" height="26" viewBox="0 0 24 24"
            fill="none" stroke="#3A57E8" stroke-width="2.2"
            stroke-linecap="round" stroke-linejoin="round">
        <path d="M3 4h14a2 2 0 0 1 2 2v14"/>
        <path d="M3 4v14a2 2 0 0 0 2 2h14"/>
        <path d="M8 8h6"/>
        <path d="M8 12h6"/>
        </svg>

        </span>
        <span class="bottom-nav-label">Dictionary</span>
    </a>

    <a href="{{ url_for('categories') }}"
       class="bottom-nav-item {% if request.endpoint in ['categories', 'show_category'] %}active{% endif %}">
        <span class="bottom-nav-icon" aria-hidden="true">
            <!-- Folder / topics icon -->
           <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
        <path d="M10 4l2 2h8c1.1 0 2 .9 2 2v10c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2h6z"/>
        </svg>

        </span>
        <span class="bottom-nav-label">Topics</span>
    </a>

    <a href="{{ url_for('search') }}"
       class="bottom-nav-item {% if request.endpoint == 'search' %}active{% endif %}">
        <span class="bottom-nav-icon" aria-hidden="true">
            <!-- Search icon -->
            <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#3A57E8" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="6" />
            <path d="M16.5 16.5L20 20" />
            </svg>

        </span>
        <span class="bottom-nav-label">Search</span>
    </a>

    <a href="{{ url_for('about') }}"
       class="bottom-nav-item {% if request.endpoint == 'about' %}active{% endif %}">
        <span class="bottom-nav-icon" aria-hidden="true">
            <!-- Info icon -->
          <svg viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="9" />
                <line x1="12" y1="10" x2="12" y2="16" />
                <circle cx="12" cy="7" r="0.5" />
            </svg>
        </span>
        <span class="bottom-nav-label">About</span>
    </a>
</nav>

<style>
    /* --- SVG icons in bottom nav --- */
/* --- SVG icons in bottom nav (improved) --- */

.bottom-nav-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
    margin-bottom: 2px; /* better spacing above label */
}

.bottom-nav-icon svg {
    width: 24px;
    height: 24px;
    stroke: #555;
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
    fill: none;
    transition: stroke 0.2s ease, transform 0.2s ease;
}

.bottom-nav-item.active .bottom-nav-icon svg {
    stroke: #1a73e8;
    transform: translateY(-1px);
    filter: drop-shadow(0 1px 1px rgba(26, 115, 232, 0.25));
}


/* Hover (desktop only) */
@media (hover: hover) {
    .bottom-nav-item:hover .bottom-nav-icon svg {
        stroke: #1a73e8;
    }
}

</style>

<script>
    // Auto-fit flashcard text to one line
    function autoFitFlashcardText() {
        const root = getFlashcardRoot();
        if (!root) return;

        const cards = root.querySelectorAll('.flashcard');

        cards.forEach(card => {
            // Fit front and back independently
            ['.front .flashcard-text', '.back .flashcard-text'].forEach(sel => {
                const el = card.querySelector(sel);
                if (!el) return;

                // Reset any old size
                el.style.fontSize = '';

                // Base font size from CSS
                const computed = window.getComputedStyle(el);
                let size = parseFloat(computed.fontSize) || 32;
                const minSize = 10;  // you can go down to 8 if you really want

                // The container that defines the visual width
                const container = el.parentElement;
                const containerWidth = container.clientWidth;
                if (containerWidth <= 0) return;

                // Ensure we test with no wrapping
                el.style.whiteSpace = 'nowrap';

                // Shrink until the text fits within the container
                while (el.scrollWidth > containerWidth && size > minSize) {
                    size -= 0.5;  // smaller step = smoother but more loops
                    el.style.fontSize = size + 'px';
                }
            });
        });
    }

    // Find whichever flashcard container exists on the current page
    function getFlashcardRoot() {
        // Category page first
        let root = document.getElementById('category-words-container');
        if (root && root.querySelector('.flashcard')) return root;

        // Words pages
        root = document.getElementById('words-container');
        if (root && root.querySelector('.flashcard')) return root;

        return null;
    }

    function bindFlashcards() {
        const root = getFlashcardRoot();
        if (!root) return;

        root.querySelectorAll('.flashcard').forEach(card => {
            if (card.dataset.bound === '1') return;
            card.dataset.bound = '1';

            card.addEventListener('click', () => {
                card.classList.toggle('flipped');
            });
        });

        // After cards exist and layout is done, fit text
        autoFitFlashcardText();
    }

    function showAllTranslations() {
        const root = getFlashcardRoot();
        if (!root) return;

        root.querySelectorAll('.flashcard').forEach(card => {
            card.classList.add('flipped');
        });
    }

    function showAllOriginals() {
        const root = getFlashcardRoot();
        if (!root) return;

        root.querySelectorAll('.flashcard').forEach(card => {
            card.classList.remove('flipped');
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
        bindFlashcards();
    });

    // Refitting on resize helps on mobile rotation
    window.addEventListener('resize', () => {
        autoFitFlashcardText();
    });

    window.bindFlashcards      = bindFlashcards;
    window.showAllTranslations = showAllTranslations;
    window.showAllOriginals    = showAllOriginals;
</script>

</body>
</html>


   
