<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <title>{{ title if title else "Finnish Vocabulary" }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600&display=swap" rel="stylesheet">
</head>

{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
<script>
document.addEventListener("DOMContentLoaded", () => {
    const container = document.getElementById("toast-container");
    if (!container) return;

    {% for category_name, message in messages %}
        const el = document.createElement("div");
        el.className = "toast {{ category_name }}";
        el.textContent = {{ message|tojson }};
        container.appendChild(el);

        setTimeout(() => el.remove(), 4000);
    {% endfor %}
});
</script>
{% endif %}
{% endwith %}

<body>
    <div id="toast-container"></div>
    <header>
        <a class="logo" href="{{ url_for('home') }}">Finnish Vocabulary</a>
        <nav class="top-nav">
            <a href="{{ url_for('home') }}"
               class="{% if request.endpoint == 'home' %}active{% endif %}">
                Home
            </a>

            <a href="{{ url_for('words_table') }}"
                class="{% if request.endpoint in ['words_table', 'words_cards', 'words_flashcards', 'show_word'] %}active{% endif %}">
                Words
            </a>

            <a href="{{ url_for('categories') }}"
               class="{% if request.endpoint in ['categories', 'show_category'] %}active{% endif %}">
                Topics
            </a>

            <a href="{{ url_for('search') }}"
               class="{% if request.endpoint == 'search' %}active{% endif %}">
                Search
            </a>

            <a href="{{ url_for('about') }}"
               class="{% if request.endpoint == 'about' %}active{% endif %}">
                About
            </a>
        </nav>
    </header>

    <main>
        {% block content %}{% endblock %}
    </main>

    <footer>
        <p>&copy; 2025 Finnish Vocabulary Project, Alexander Zakharov</p>
    </footer>

    {# --- Bottom navigation (mobile only, via CSS) --- #}
    <nav class="bottom-nav">
        <a href="{{ url_for('home') }}"
           class="bottom-nav-item {% if request.endpoint == 'home' %}active{% endif %}">
            <span class="bottom-nav-icon">üè†</span>
            <span class="bottom-nav-label">Home</span>
        </a>

        <a href="{{ url_for('words_table') }}"
           class="bottom-nav-item {% if request.endpoint in ['words_table', 'words_cards', 'words_flashcards'] %}active{% endif %}">
            <span class="bottom-nav-icon">üìö</span>
            <span class="bottom-nav-label">Words</span>
        </a>

        <a href="{{ url_for('categories') }}"
           class="bottom-nav-item {% if request.endpoint in ['categories', 'show_category'] %}active{% endif %}">
            <span class="bottom-nav-icon">üìÇ</span>
            <span class="bottom-nav-label">Topics</span>
        </a>

        <a href="{{ url_for('search') }}"
           class="bottom-nav-item {% if request.endpoint == 'search' %}active{% endif %}">
            <span class="bottom-nav-icon">üîç</span>
            <span class="bottom-nav-label">Search</span>
        </a>

        <a href="{{ url_for('about') }}"
           class="bottom-nav-item {% if request.endpoint == 'about' %}active{% endif %}">
            <span class="bottom-nav-icon">‚ÑπÔ∏è</span>
            <span class="bottom-nav-label">About</span>
        </a>
    </nav>


    <script>
    // ============ FLASHCARDS ‚Äî shared for ALL pages ============

    // Find whichever flashcard container exists on the current page
    function getFlashcardRoot() {
        // Category page first
        let root = document.getElementById('category-words-container');
        if (root && root.querySelector('.flashcard')) return root;

        // Words pages
        root = document.getElementById('words-container');
        if (root && root.querySelector('.flashcard')) return root;

        return null;
    }

    // Flip individual cards on click
    function bindFlashcards() {
        const root = getFlashcardRoot();
        if (!root) return;

        root.querySelectorAll('.flashcard').forEach(card => {
            if (card.dataset.bound === '1') return; // avoid double binding
            card.dataset.bound = '1';

            card.addEventListener('click', () => {
                card.classList.toggle('flipped');
            });
        });
    }

    // Always show translations on ALL cards
    function showAllTranslations() {
        const root = getFlashcardRoot();
        if (!root) return;

        root.querySelectorAll('.flashcard').forEach(card => {
            card.classList.add('flipped');
        });
    }

    // Always show original words on ALL cards
    function showAllOriginals() {
        const root = getFlashcardRoot();
        if (!root) return;

        root.querySelectorAll('.flashcard').forEach(card => {
            card.classList.remove('flipped');
        });
    }

    // Run once on every page load
    document.addEventListener('DOMContentLoaded', () => {
        bindFlashcards();
    });

    // Expose to other scripts (AJAX pages, etc.)
    window.bindFlashcards       = bindFlashcards;
    window.showAllTranslations  = showAllTranslations;
    window.showAllOriginals     = showAllOriginals;
    </script>
</body>
</html>


   
